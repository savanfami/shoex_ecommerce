<%-include("../partials/adminPartials/sidebar")%>

    <style>
        .product-text-container {
            /* background-color: aqua; */
            border-radius: 12px;
            width: 100%;
            height: 56px;
            margin-top: 73px;
            box-shadow: 0px 0px 7px -3px;
        }
    </style>

    <div class="product-text-container container-fluid" style="display: flex; justify-content: space-between;">
        <h4 style=" margin-top: 11px;" id="ManageProduct-text">PRODUCT MANAGEMENT</h4>
    </div>
    <br>
    <a href="/admin/toadd-Product" class="btn btn-primary">Add Product</a>
    <div class="option d-flex align-items-center justify-content-center mt-3 ">
      
        <form action="/admin/searchProduct" method="post" name="name">
          <div class="input-group">
            <div class="form-outline d-flex p-3">
              <input type="search" class="form-control " name="search" placeholder="Search">
              <button id="search-button" type="submit" class="btn btn-danger mx-2">search</button>
            </div>
          </div>
        </form>
      </div>
    <table class="table align-middle mb-0 bg-white mt-4 table-bordered" style="border:2px black;">
        <thead class="text-white" style="background-color: black;">
            <tr>
                <th>No</th>
                <th>image</th>
                <th>Product Name</th>
                <th>Price</th>
                <th>Brand</th>
                <th>Category</th>
                <th>Size</th>
                <th>Quantity</th>
                <th>Color</th>
                <th>Status</th>
                <th>Edit</th>
                <th>Action</th>
                <th>Delete</th>
            </tr>
        </thead>
        <tbody>
           <% if (productData && productData.length>0) { %>
            <% productData.forEach(data=> { %>
                <tr>
                    <td>
                        <%=++i %>
                    </td>
                    <td>
                        <img src="/productImages/<%=data.images[0] %>" alt="" style="width: 100px; height: 80px ">
                    </td>
                    <td>
                        <%=data.name %>
                    </td>
                    <td>
                        <%=data.price %>
                    </td>
                    <td>
                        <%=data.brand %>
                    </td>
                    <td>
                        <%=data.category %>
                    </td>
                    <td>
                        <% data.variant.forEach(element=> { %>
                            <%=element.size %>
                                <br>
                                <% }) %>
                    </td>
                    <td>
                        <% data.variant.forEach(element=> { %>
                            <%=element.quantity %>
                                <br>
                                <% }) %>
                    </td>
                    <td>
                        <%=data.color %>
                    </td>
                    <td class="<%= data.status ? 'text-success fw-bold' : 'text-danger fw-bold' %> table-white ">
                        <% if (data.status) { %>
                            <% value='Active' ; %>
                                <% } else { %>
                                    <% value='Inactive' ; %>
                                        <% } %>
                                            <%= value %>
                    </td>
                    <td>
                        <a href="/admin/edit-Product/<%-data._id %>" class="text-white">
                            <i class="fa-solid fa-pen-to-square fa-xl" style="color: #000000;"></i>
                          </a>
                    </td>
                    <td>
                        <% if (data.status) { %>
                            <!-- If user is active, provide option to block -->
                            <form action="/admin/block-Product/<%- data._id %>" method="POST">
                                <button type="submit" class="text-white font-size btn btn-danger px-3 py-0"
                                    onclick="return confirm('Are you sure you want to block <%=data.name%>?')">Disable</button>
                            </form>
                            <% } else { %>
                                <!-- If user is inactive, provide option to unblock -->
                                <form action="/admin/unblock-Product/<%- data._id %>" method="post">
                                    <button type="submit" class="text-white font-size btn btn-primary px-3 py-0"
                                        onclick="return confirm('Are you sure you want to un-block <%=data.name%>?')">Enable</button>
                                </form>
                                <% } %>

                    </td>
                    <td>
                        <a href="/admin/delete-Product/<%-data._id %>" onclick="return confirm('Are you sure you want to delete <%=data.name%>')"  method="post">
                        <i class="fas fa-trash fa-xl" style="color:red;"></i>
                        </a>
                    </td>
                </tr>
                <% }) %>
                <% } else {%>
                    <tr>
                        <td colspan="13" class="text-center">No products found</td>
                    </tr>
                <% } %>
        </tbody>
    </table>
    <!-- <script>
        function searchResult(name){
            fetch('/admin-productSearch',{
                method:"post",
                headers:'application/json'
            },body:JSON.stringify({})
            )
        }
    </script> -->