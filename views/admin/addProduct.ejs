
<%-include("../partials/adminPartials/header")%>
<style>
  .product-text-container{
  /* background-color: aqua; */
  border-radius: 12px;
  width: 100%;
  height: 56px;
  margin-top: 73px;
  box-shadow: 0px 0px 7px -3px;
  }
  .image-preview {
      display: flex;
      flex-wrap: wrap;
    }

    .preview-container {
      margin-right: 10px;
      margin-bottom: 10px;
    }

    .preview-image {
      max-width: 100px;
      max-height: 100px;
      border: 1px solid #ccc;
      margin-bottom: 5px;
    }
    #form{
    border: 2px ; /* Add border style here */
    padding: 15px; /* Add padding for better appearance */
    border-radius: 10px; /* Optional: Add border radius for rounded corners */
    box-shadow: 0px 0px 7px -3px;
  }

</style>

<div class="product-text-container container" style="display: flex; justify-content: space-between;">
  <h4 style="    margin-top: 11px;" id="ManageProduct-text"> ADD PRODUCT</h4>

</div>
<div class="container mt-5">

  <!-- Bootstrap form with grid layout -->
  <form action="/admin/add-Product " method="POST" id="form" enctype="multipart/form-data">

      <!-- General Information Section -->
      <div class="row mb-4">
          <div class="col-md-6">
              <label for="productName" class="form-label">Product Name</label>
              <input type="text" class="form-control" id="productName" name="name" placeholder="Product name" required>
          </div>
          <div class="col-md-6">
              <label for="productPrice" class="form-label">Price</label>
              <input type="number" class="form-control" id="productPrice" name="price" placeholder="Price" required>
          </div>
      </div>

      <div class="row mb-4">
          <div class="col-md-6">
              <label for="productDescription" class="form-label">Product Description</label>
              <textarea class="form-control" id="productDescription" name="description" placeholder="Product Description" rows="3" required></textarea>
          </div>
          <div class="col-md-6">
            <label for="productColor" class="form-label">Color</label>
            <input type="text" class="form-control" id="productColor" name="color" placeholder="Color">
        </div>
        <div class="col-md-6">
          <label for="productColor" class="form-label">Brand</label>
          <input type="text" class="form-control" id="productColor" name="brand" placeholder="brand name">
      </div>
      <div class="col-md-6">
      <label for="productColor" class="form-label">Category</label>
      <select class="form-select form-select-input form-select-sm shadow-none" name="category" id="category"
         aria-label=".form-select-sm example">
        <option selected>Select Category</option>
        <% categoryData.forEach(data => { %>
          <option value="<%=data.name %>"><%=data.name %></option>
      
        <% }) %>
      </select>
    </div>
      </div>

      <div class="row mb-4">
        <!-- Add Variant Button -->
        <div class="col-md-12 d-flex justify-content-center">
            <button type="button" class="btn btn-primary" id="addVariant">Add Variant</button>
        </div>
    </div>
    
    <!-- Size and Color Section -->
<!-- Size and Quantity Section -->
<div id="variantSection">
  <!-- Variant Template -->
  <div class="variant-row row mb-4" data-variant-index="0">
    <div class="col-md-6">
      <label for="productSize" class="form-label">Size</label>
      <input type="number" class="form-control" name="variant[size][]"  placeholder="Size">
    </div>
    <div class="col-md-6">
      <label for="productStock" class="form-label">Stock Quantity</label>
      <input type="number" class="form-control" name="variant[quantity][]" placeholder="Stock" required>
    </div>
    <!-- Remove Variant Icon -->
    <div class="col-md-12 mt-2 d-flex justify-content-end">
      <!-- Ensure at least one variant is always present -->
      <button type="button" class="btn btn-danger" onclick="removeVariant(this)" disabled>&times;</button>
    </div>
  </div>
</div>

<!-- Add Variant Button -->
<!-- <div class="col-md-12 d-flex justify-content-center">
  <button type="button" class="btn btn-primary" id="addVariant">Add Variant</button>
</div> -->

      <!-- Image Upload Section -->
      <div class="row mb-4">
        <div class="mb-3">
          <label for="imageInput1"  class="form-label">Main Image</label>
          <input type="file" class="form-control" id="imageInput1" name="mainImage" accept="image/*" required>
          <img id="imagePreview1" src="" class="img-thumbnail mt-2" alt="Preview" style="width: 150px; height: 150px;">
          <button class="btn btn-danger mt-2 delete-button" id="deleteButton1"
              style="display: none">Delete</button>
        </div>
    
        <div class="mb-3">
          <label for="imageInput2" class="form-label">Product Image:</label>
          <input type="file" class="form-control" id="imageInput2" name="image1" accept="image/*" required>
          <img id="imagePreview2" src="" class="img-thumbnail mt-2" alt="Preview" style="width: 150px; height: 150px;">
          <button class="btn btn-danger mt-2 delete-button" id="deleteButton2"
              style="display: none">Delete</button>
        </div>
    
        <div class="mb-3">
          <label for="imageInput3" class="form-label">Product Image:</label>
          <input type="file" class="form-control" id="imageInput3" name="image2" accept="image/*" required>
          <img id="imagePreview3" src="" class="img-thumbnail mt-2" alt="Preview" style="width: 150px; height: 150px;">
          <button class="btn btn-danger mt-2 delete-button" id="deleteButton3"
              style="display: none">Delete</button>
        </div>
        <div class="mb-3">
          <label for="imageInput4" class="form-label">Product Image:</label>
          <input type="file" class="form-control" id="imageInput4" name="image3" accept="image/*" >
          <img id="imagePreview4" src="" class="img-thumbnail mt-2" alt="Preview" style="width: 150px; height: 150px;">
          <button class="btn btn-danger mt-2 delete-button" id="deleteButton4"
              style="display: none">Delete</button>
        </div>

        <div class="mb-3">
          <label for="imageInput5" class="form-label">Product Image:</label>
          <input type="file" class="form-control" id="imageInput5" name="image4" accept="image/*">
          <img id="imagePreview5" src="" class="img-thumbnail mt-2" alt="Preview" style="width: 150px; height: 150px;">
          <button class="btn btn-danger mt-2 delete-button" id="deleteButton5"
              style="display: none">Delete</button>
        </div>
      </div>

      <!-- Submit Button -->
      <button type="submit" class="btn btn-primary">Add Product</button>
      <a href="/admin/manage-Product" class="btn btn-secondary">Back to Product</a>

  </form>

</div>
<script>
  document.getElementById('addVariant').addEventListener('click', function () {
    // Clone the existing variant section and append it to the variantSection div
    var index = document.querySelectorAll('#variantSection .variant-row').length;
    var newVariantSection = document.querySelector('#variantSection .variant-row').cloneNode(true);
  
    // Update the variant index in the new variant section
    newVariantSection.setAttribute('data-variant-index', index);
  
    // Enable the remove button in the new variant section
    newVariantSection.querySelector('button').removeAttribute('disabled');
  
    // Clear input values in the new variant section
    newVariantSection.querySelectorAll('input').forEach(input => {
      input.value = '';
    });
  
    document.getElementById('variantSection').appendChild(newVariantSection);
  });
  
  function removeVariant(button) {
    var variantSection = document.getElementById('variantSection');
  
    // Ensure at least one variant is always present
    if (variantSection.querySelectorAll('.variant-row').length > 1) {
      // Remove the parent row of the clicked button
      button.closest('.variant-row').remove();
    }
  }
  </script>
    <!-- <script>
      function previewImage(input, previewId) {
        const preview = document.getElementById(previewId);
        while (preview.firstChild) {
          preview.removeChild(preview.firstChild);
        }
  
        const files = input.files;
  
        for (let i = 0; i < files.length; i++) {
          const file = files[i];
          const reader = new FileReader();
  
          reader.onload = function (e) {
            const img = document.createElement("img");
            img.className = "preview-image";
            img.src = e.target.result;
            preview.appendChild(img);
          };
  
          reader.readAsDataURL(file);
        }
      }
  
      document.getElementById("mainImage").addEventListener("change", function () {
        previewImage(this, "mainImagePreview");
      });
  
      document.getElementById("categoryImage1").addEventListener("change", function () {
        previewImage(this, "categoryImagePreview1");
      });
  
      document.getElementById("categoryImage2").addEventListener("change", function () {
        previewImage(this, "categoryImagePreview2");
      });
  
      document.getElementById("categoryImage3").addEventListener("change", function () {
        previewImage(this, "categoryImagePreview3");
      });
  
      document.getElementById("categoryImage4").addEventListener("change", function () {
        previewImage(this, "categoryImagePreview4");
      });
    </script> -->
  
  <script>
    // JavaScript to handle image preview and delete
    const inputIds = ["1", "2", "3", "4","5"];

    inputIds.forEach((id) => {
        const input = document.getElementById(`imageInput${id}`);
        const preview = document.getElementById(`imagePreview${id}`);
        const deleteButton = document.getElementById(`deleteButton${id}`);

        input.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (event) => {
                    preview.src = event.target.result;
                    deleteButton.style.display = 'block';
                };
                reader.readAsDataURL(file);
            }
        });

        deleteButton.addEventListener('click', () => {
            input.value = '';
            preview.src = '';
            deleteButton.style.display = 'none';
        });
    });
</script>
<%-include("../partials/adminPartials/footer")%>